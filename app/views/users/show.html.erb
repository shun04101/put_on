<div class="container">
  <div class = "flash_message text-center text-success"><%= flash[:success] %></div>
  
  <div class="mypage-content">
    
    <div class="mypage-left">
      <h3 class="text-decoration-underline"><u><%= @user.nickname %>さんのマイページ</u></h3>
      <p class="text-small"><%= link_to @user.followings.count, user_followings_path(@user) %>フォロー <%= link_to @user.followers.count, user_followers_path(@user) %>フォロワー</p>
      <!--ログインユーザーのマイページ-->
      <% if user_signed_in? && current_user.id.to_s == params[:id] %>
        <div class="row">
          <h5 class="font-weight-bold col-4 align-self-center">会員情報</h5>
          <div class="col-8"><%= link_to "編集する", edit_user_path, class:"btn btn-outline-success" %></div>
        </div>
        
        <table class="table table-light col-md-12 mt-12 mypage-left-info">
          <tr>
            <td class="info border border-dark table-active">氏名</td>
            <td class="border border-dark"><%= @user.last_name %> <%= @user.first_name %></td>
          </tr>
          <tr>
            <td class="info border border-dark table-active">カナ</td>
            <td class="border border-dark"><%= @user.last_name_kana %>  <%= @user.first_name_kana %></td>
          </tr>
          <tr>
            <td class="info border border-dark table-active">ニックネーム</td>
            <td class="border border-dark"><%= @user.nickname %></td>
          </tr>
           <tr>
            <td class="info border border-dark table-active">メールアドレス</td>
            <td class="border border-dark"><%= @user.email %></td>
          </tr>
        </table>
        
        <% else %>
          <h4 class="">ニックネーム：<%= @user.nickname %></h4>
          <% if current_user.following?(@user) %>
            <%= link_to "フォロー外す", user_relationships_path(@user.id), method: :delete, class:"btn btn-outline-danger" %>
          <% else %>
            <%= link_to "フォローする", user_relationships_path(@user.id), method: :post, class:"btn btn-outline-primary" %>
          <% end %>
          <h4 class="page-header">最新2件の投稿</h4>
          <ul class="list-group">
            <% @posts.each do |post| %>
              <li class="list-group-item">
                <span class="badge text-danger"><%= link_to "[詳細]", post_path(post.id) %></span>
                <%= @user.nickname %> | <%= post.title %> | <%= post.comment.truncate(25) %>
                <i class="fas fa-tag"><%= post.tags.map(&:tag_name).join(', ') %></i>
                <i class="far fa-clock"><%= time_ago_in_words(post.created_at)+"前" %></i>
              </li>
            <% end %>
          <div class="col-5"><%= link_to "全投稿を見る", posts_path(user_id: @user.id), class:"btn btn-outline-primary col-xs-3 offset-xs-3" %></div>
        <% end %>
    </div>
    
    <div class="mypage-right">
      <!--ログインユーザーのマイページ-->
      <% if user_signed_in? && current_user.id.to_s == params[:id] %>
        <div class="row">
          <h4 class="page-header col-6">最新2件の投稿</h4>
          <div class="col-6"><%= link_to "全投稿を見る", posts_path(user_id: @user.id), class:"btn btn-outline-primary col-xs-3 offset-xs-3" %></div>
        </div>
        <ul class="list-group">
          <% @posts.each do |post| %>
            <li class="list-group-item">
              <span class="badge text-danger"><%= link_to "[詳細]", post_path(post.id) %></span>
              <%= @user.nickname %> | <%= post.title %> | <%= post.comment.truncate(25) %>
              <i class="fas fa-tag"><%= post.tags.map(&:tag_name).join(', ') %></i>
              <i class="far fa-clock"><%= time_ago_in_words(post.created_at)+"前" %></i>
            </li>
          <% end %>
      <% end %>
    </div>
  </div>
  
  <!--ログインユーザーのマイページ-->
  <% if user_signed_in? && current_user.id.to_s == params[:id] %>
    <h5 class="font-weight-bold align-self-center">ブックマーク一覧</h5>
    <table class="table table-hover">
      <thead>
        <tr>
          <th>ニックネーム</th>
          <th>タイトル</th>
          <th>コメント</th>
        </tr>
        </thead>
        <tbody>
          <% @bookmarks.each do |bookmark| %>
            <tr>
              <td><%= bookmark.post.user.nickname %></td>
              <td>
                <%= link_to post_path(bookmark.post) do %>
                  <%= bookmark.post.title %>
                <% end %>
              </td>
              <td><%= bookmark.post.comment %></td>
            </tr>
          <% end %>
      </tbody>
    </table>
  <% end %>
</div>